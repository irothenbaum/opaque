!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("opaque",[],e):"object"==typeof exports?exports.opaque=e():t.opaque=e()}(window,function(){return function(t){var e={};function n(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(o,r,function(e){return t[e]}.bind(null,r));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=2)}([function(t,e,n){(function(t){var n,o,r;function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(u,c){"object"===i(e)&&"object"===i(t)?t.exports=c():(o=[],void 0===(r="function"==typeof(n=c)?n.apply(e,o):n)||(t.exports=r))}(window,function(){return function(t){var e={};function n(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===i(t)&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(o,r,function(e){return t[e]}.bind(null,r));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=13)}([function(t,e,n){var o=n(7);Constants={TAU:2*Math.PI},Functions={disjoinArray2FromArray1:function(t,e,n){var o,r;if(e.length)for(o=0;o<e.length;o++)for(r=0;r<t.length;r++)if(t[r].__id===e[o].__id){"function"==typeof n&&n(t[r]),delete t[r].__id,t.splice(r,1);break}},clone:function(t){return Object.assign(Object.create(Object.getPrototypeOf(t)),t)}},Geometry={boxCollidesBox:function(t,e){var n=t.origin_x<=e.origin_x&&t.origin_x+t.width>e.origin_x||e.origin_x<=t.origin_x&&e.origin_x+e.width>t.origin_x,o=t.origin_y<=e.origin_y&&t.origin_y+t.height>e.origin_y||e.origin_y<=t.origin_y&&e.origin_y+e.height>t.origin_y;return n&&o},boxCollidesCircle:function(t,e){var n={x:t.origin_x,y:t.origin_y},o={x:t.origin_x+t.width,y:t.origin_y},r={x:t.origin_x+t.width,y:t.origin_y+t.height},i={x:t.origin_x,y:t.origin_y+t.height},u=[n,o],c=[o,r],l=[r,i],a=[i,n];return Geometry.pointCollidesBox(e,t)||Geometry.lineCollidesCircle(u,e,!0)||Geometry.lineCollidesCircle(c,e,!0)||Geometry.lineCollidesCircle(l,e,!0)||Geometry.lineCollidesCircle(a,e,!0)},boxCollidesPoint:function(t,e){return e.x>=t.origin_x&&t.origin_x+t.width>=e.x&&e.y>=t.origin_y&&t.origin_y+t.height>=e.y},circleCollidesCircle:function(t,e){return this.distanceToPoint(t,e)<t.radius+e.radius},circleCollidesBox:function(t,e){return Geometry.boxCollidesCircle(e,t)},circleCollidesLine:function(t,e,n){return Geometry.lineCollidesCircle(e,cricle,n)},circleCollidesPoint:function(t,e){return Geometry.pointCollidesCircle(e,t)},lineIntersectsCircle:function(t,e,n){var o=t[0],r=t[1],i=Math.sqrt(Math.pow(o.x-r.x,2)+Math.pow(o.y-r.y,2)),u=(o.x-r.x)/i,c=(o.y-r.y)/i,l=u*(e.x-r.x)+c*(e.y-r.y),a={x:l*u+r.x,y:l*c+r.y},s=Math.sqrt(Math.pow(a.x-e.x,2)+Math.pow(a.y-e.y,2)),f=[];if(s<e.radius){var p=Math.sqrt(Math.pow(e.radius,2)-Math.pow(s,2)),y={x:(l-p)*u+r.x,y:(l-p)*c+r.y};n&&!Geometry.lineCollidesPoint(t,y,!0)||f.push(y);var h={x:(l+p)*u+r.x,y:(l+p)*c+r.y};n&&!Geometry.lineCollidesPoint(t,h,!0)||f.push(h)}else parseInt(s)===parseInt(e.radius)&&(n&&!Geometry.lineCollidesPoint(t,a,!0)||f.push(a));return f},lineCollidesCircle:function(t,e,n){return Geometry.lineIntersectsCircle(t,e,n).length>0||Geometry.pointCollidesCircle(t[0],e)},lineCollidesPoint:function(t,e,n){var o=Geometry.angleToPoint(t[0],e),r=Geometry.angleToPoint(t[1],e),i=o===r;return i||(i=o===(r=Geometry.angleToPoint(e,t[1]))),i&&n&&(i=Geometry.distanceToPoint(t[0],e)+Geometry.distanceToPoint(t[1],e)===Geometry.distanceToPoint(t[0],t[1])),i},pointCollidesCircle:function(t,e){return Geometry.distanceToPoint(t,e)<=e.radius},pointCollidesBox:function(t,e){return Geometry.boxCollidesPoint(e,t)},pointCollidesPoint:function(t,e){return t.x===e.x&&t.y===e.y},pointCollidesLine:function(t,e){return Geometry.lineCollidesPoint(e,t)},distanceToPoint:function(t,e){var n=t.x-e.x,o=t.y-e.y;return Math.sqrt(n*n+o*o)},angleToPoint:function(t,e,n){var o=Math.atan2(e.y-t.y,e.x-t.x);return n?180*o/Math.PI:o},pointToPoint:function(t,e){return new o({speed:Geometry.distanceToPoint(t,e),direction:Geometry.angleToPoint(t,e)})},pointFromVector:function(t,e){return{x:t.x+Math.cos(e.getDirection())*e.getSpeed(),y:t.y+Math.sin(e.getDirection())*e.getSpeed()}},getRandomDirection:function(){return 2*Math.random()*Math.PI}},t.exports={Geometry:Geometry,Functions:Functions,Constants:Constants}},function(t,e){t.exports=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}},function(t,e,n){function o(t){return(o="function"==typeof Symbol&&"symbol"===i(Symbol.iterator)?function(t){return i(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":i(t)})(t)}function r(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function u(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var a=n(1),s=n(3),f=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=u(this,c(e).call(this,t))).setBounding(t.bounding),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(e,a),function(t,e,n){e&&r(t.prototype,e),n&&r(t,n)}(e,[{key:"collides",value:function(t){return this._bounding&&this._bounding.collides(t)}},{key:"getBounding",value:function(){return this._bounding}},{key:"setBounding",value:function(t){if(!(t||t instanceof s))throw"All objects must have a true bounding";return this._bounding=t}}]),e}();t.exports=f},function(t,e,n){function o(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function r(t){return(r="function"==typeof Symbol&&"symbol"===i(Symbol.iterator)?function(t){return i(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":i(t)})(t)}function u(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function c(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var s=n(1),f=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=c(this,l(e).call(this,t))).rotation=0,Object.entries(t).forEach(function(t){n[t[0]]=t[1]}),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(e,s),function(t,e,n){e&&u(t.prototype,e),n&&u(t,n)}(e,[{key:"getCenter",value:function(){return{x:null,y:null}}},{key:"setCenter",value:function(t){return null}},{key:"setCenterWithinContainer",value:function(t,e){return this.setCenter(t)}},{key:"getContainingRectangle",value:function(){return{origin_x:null,origin_y:null,width:null,height:null}}},{key:"getRotation",value:function(){return this.rotation}},{key:"setRotation",value:function(t){this.rotation=t}},{key:"updateBounding",value:function(t,e){var n=this;return"object"===r(t)?Object.entries(t).forEach(function(t){n.updateBounding.apply(n,o(t))}):this[t]=e,this}},{key:"collides",value:function(t){return!1}}]),e}();t.exports=f},function(t,e,n){function o(t){return(o="function"==typeof Symbol&&"symbol"===i(Symbol.iterator)?function(t){return i(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":i(t)})(t)}function r(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function u(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var a=n(3),s=n(0).Geometry,f=n(6),p=n(5),y=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),u(this,c(e).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(e,a),function(t,e,n){e&&r(t.prototype,e),n&&r(t,n)}(e,[{key:"getCenter",value:function(){return{x:this.x,y:this.y}}},{key:"setCenter",value:function(t){this.x=t.x,this.y=t.y}},{key:"getContainingRectangle",value:function(){return{origin_x:this.x,origin_y:this.y,width:0,height:0}}},{key:"collides",value:function(t){return t instanceof f?s.pointCollidesBox(this,t):t instanceof p?s.pointCollidesCircle(this,t):t instanceof e?s.pointCollidesPoint(this,t):t instanceof a?t.collides(this):s.circleCollidesPoint(this,t)}}]),e}();t.exports=y},function(t,e,n){function o(t){return(o="function"==typeof Symbol&&"symbol"===i(Symbol.iterator)?function(t){return i(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":i(t)})(t)}function r(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function u(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var a=n(3),s=n(0).Geometry,f=n(6),p=n(4),y=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),u(this,c(e).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(e,a),function(t,e,n){e&&r(t.prototype,e),n&&r(t,n)}(e,[{key:"getCenter",value:function(){return{x:this.x,y:this.y}}},{key:"setCenter",value:function(t){this.x=t.x,this.y=t.y}},{key:"getContainingRectangle",value:function(){return{origin_x:this.x-this.radius,origin_y:this.y-this.radius,width:2*this.radius,height:2*this.radius}}},{key:"collides",value:function(t){return t instanceof f?s.circleCollidesBox(this,t):t instanceof e?s.circleCollidesCircle(this,t):t instanceof p?s.circleCollidesPoint(this,t):t instanceof a?t.collides(this):s.circleCollidesPoint(this,t)}}]),e}();t.exports=y},function(t,e,n){function o(t){return(o="function"==typeof Symbol&&"symbol"===i(Symbol.iterator)?function(t){return i(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":i(t)})(t)}function r(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function u(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var a=n(3),s=n(0).Geometry,f=n(5),p=n(4),y=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),u(this,c(e).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(e,a),function(t,e,n){e&&r(t.prototype,e),n&&r(t,n)}(e,[{key:"getCenter",value:function(){return{x:this.origin_x+this.width/2,y:this.origin_y+this.height/2}}},{key:"setCenter",value:function(t){this.origin_x=t.x-this.width/2,this.origin_y=t.y-this.height/2}},{key:"setCenterWithinBounding",value:function(t,e){var n=e.getContainingRectangle(),o=this.getContainingRectangle(),r=t.x,i=t.y;n.width<o.width?r=e.getCenter().x:(r=Math.min(t.x,n.origin_x+n.width-o.width/2),r=Math.max(r,n.origin_x+o.width/2)),n.height<o.height?i=e.getCenter().y:(i=Math.min(t.y,n.origin_y+n.height-o.height/2),i=Math.max(i,n.origin_y+o.height/2)),this.setCenter({x:r,y:i})}},{key:"getContainingRectangle",value:function(){return{origin_x:this.origin_x,origin_y:this.origin_y,width:this.width,height:this.height}}},{key:"collides",value:function(t){return t instanceof e?s.boxCollidesBox(this,t):t instanceof f?s.boxCollidesCircle(this,t):t instanceof p?s.boxCollidesPoint(this,t):t instanceof a?t.collides(this):s.boxCollidesPoint(this,t)}}]),e}();t.exports=y},function(t,e,n){function o(t){return(o="function"==typeof Symbol&&"symbol"===i(Symbol.iterator)?function(t){return i(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":i(t)})(t)}function r(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function u(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var a=n(1),s=n(0).Constants,f=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=u(this,c(e).call(this,t)),t=Object.assign({direction:0,speed:0},t),n.__direction=t.direction,n.__speed=t.speed,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(e,a),function(t,e,n){e&&r(t.prototype,e),n&&r(t,n)}(e,[{key:"getDirection",value:function(){return this.__direction}},{key:"getSpeed",value:function(){return this.__speed}},{key:"setDirection",value:function(t){this.__direction=t}},{key:"setSpeed",value:function(t){this.__speed=t}},{key:"rotateTowards",value:function(t,e){var n=this.getDirection(),o=(t+s.TAU-n)%s.TAU;e=e||1,o<=Math.PI?this.setDirection(n+o/e):this.setDirection(n-(o-Math.PI)/e)}}]),e}();t.exports=f},function(t,e,n){function o(t){return(o="function"==typeof Symbol&&"symbol"===i(Symbol.iterator)?function(t){return i(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":i(t)})(t)}function r(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function u(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var a=n(2),s=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),u(this,c(e).call(this,t))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(e,a),function(t,e,n){e&&r(t.prototype,e),n&&r(t,n)}(e,[{key:"draw",value:function(t,e,n,o){var r=t.getContext("2d");r.beginPath(),r.arc(e,n,20,0,2*Math.PI,!1),r.fillStyle="grey",r.fill(),r.lineWidth=5,r.strokeStyle="#333333",r.stroke()}}]),e}();t.exports=s},function(t,e,n){function o(t){return(o="function"==typeof Symbol&&"symbol"===i(Symbol.iterator)?function(t){return i(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":i(t)})(t)}function r(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function u(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var a=n(1),s=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=u(this,c(e).call(this,t)),t=Object.assign({color:"transparent"},t),n._color=t.color,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(e,a),function(t,e,n){e&&r(t.prototype,e),n&&r(t,n)}(e,[{key:"draw",value:function(t){var e=t.getCanvas(),n=t.getBounding().getContainingRectangle(),o=e.getContext("2d");o.beginPath(),o.fillStyle=this._color,o.fillRect(0,0,n.width,n.height),o.fill(),o.stroke()}}]),e}();t.exports=s},function(t,e,n){function o(t){return(o="function"==typeof Symbol&&"symbol"===i(Symbol.iterator)?function(t){return i(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":i(t)})(t)}function r(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function c(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function l(t,e,n){return e&&c(t.prototype,e),n&&c(t,n),t}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var s=n(4),f=n(0).Geometry,p=function(t){function e(t,n){var o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=r(this,u(e).call(this,t,n));for(var i=t.target,c=0,l=0;i&&!isNaN(i.offsetLeft)&&!isNaN(i.offsetTop);)c+=i.offsetLeft-i.scrollLeft,l+=i.offsetTop-i.scrollTop,i=i.offsetParent;if(o._super("initialize",{x:t.clientX-c,y:t.clientY-l}),n){o.world_x=o.x+n.getBounding().origin_x,o.world_y=o.y+n.getBounding().origin_y;var a=n.getCanvas().getBoundingClientRect();o.device_x=o.x+a.left,o.device_y=o.y+a.top}return o.timestamp=Date.now(),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(e,s),l(e,null,[{key:"EVENT_TYPES",get:function(){return{TAP:"tap",DOUBLE:"doubletap",LONG:"longtap",MOVE:"mousemove",UP:"mouseup",DOWN:"mousedown"}}}]),l(e,[{key:"linkEvent",value:function(t){return t instanceof e&&(this.linked_event=t,this.velocity=f.pointToPoint(this.linked_event,this)),this}},{key:"setType",value:function(t){if(-1===e.EVENT_TYPES.values().indexOf(t))throw"Invalid event type";return this.type=t,this}},{key:"getType",value:function(){return this.type?this.type:null}}]),e}();t.exports=p},function(t,e,n){function o(t){return(o="function"==typeof Symbol&&"symbol"===i(Symbol.iterator)?function(t){return i(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":i(t)})(t)}function r(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var a=n(10),s=n(0).Geometry,f=n(2),p=function(t){function e(t){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=function(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?l(t):e}(this,u(e).call(this,t))).__view=t.view,t=Object.assign({bounding:n.__view.getBounding(),double:300,tap:300,tap_distance:20},t),n.setBounding(t.bounding),n._doubleTapThreshold=t.double,n._tapThreshold=t.tap,n._tapDistanceThreshold=t.tap_distance,n._longTapCancel=2*n._tapThreshold,t.absolute&&(n.__boundToWorld=!0),n._lastUp=null,n._lastDown=null,n._lastMove=null,a.EVENT_TYPES.forEach(function(t){n.__getListenersByType.call(l(l(n)),t)}),n.__id=null,n.__key=0,n.__isDown=!1;var r=l(l(n));return n.__view.getCanvas().addEventListener("mousedown",function(t){r._handleDown.apply(r,arguments)},!1),n.__view.getCanvas().addEventListener("touchstart",function(t){t.preventDefault(),r._handleDown.apply(r,arguments)},!1),n.__view.getCanvas().addEventListener("mouseup",function(t){r._handleUp.apply(r,arguments)},!1),n.__view.getCanvas().addEventListener("touchend",function(t){t.preventDefault(),r._handleUp.apply(r,arguments)},!1),n.__view.getCanvas().addEventListener("mousemove",function(t){r._handleMove.apply(r,arguments)},!1),n.__view.getCanvas().addEventListener("touchmove",function(t){t.preventDefault(),r._handleMove.apply(r,arguments)},!1),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(e,f),function(t,e,n){e&&r(t.prototype,e),n&&r(t,n)}(e,[{key:"draw",value:function(){this.getAppearance()&&this.getAppearance().draw(this.__view.getCanvas(),this.getBounding().getCenter().x,this.getBounding().getCenter().y,this)}},{key:"setAppearance",value:function(t){this.__appearance=t}},{key:"getAppearance",value:function(t){return this.__appearance}},{key:"_handleDown",value:function(t){var e=this.__formatTouchEvent(t);e&&(e.setType(a.EVENT_TYPES.DOWN),this.__isDown=!0,this.__lastDown=e,this.__fireEvent(e))}},{key:"_handleUp",value:function(t){var e=this.__formatTouchEvent(t);if(e&&this.isDown()){var n=!1;if(this.__lastUp&&this.__lastUp.type==a.EVENT_TYPES.TAP&&this.__lastUp.timestamp-e.timestamp<=this._doubleTapThreshold&&(e.setType(a.EVENT_TYPES.DOUBLE),n=!0),!n&&this.__lastDown&&s.distanceToPoint(this.__lastDown,e)<this._tapDistanceThreshold){var o=e.timestamp-this.__lastDown.timestamp;o<=this._tapThreshold?(e.setType(a.EVENT_TYPES.TAP),n=!0):o<=this._longTapCancel&&(e.setType(a.EVENT_TYPES.LONG),n=!0)}n||e.setType(a.EVENT_TYPES.UP),e.linkEvent(this.__lastDown),this.__lastUp=e,this.__fireEvent(e),this.__isDown=!1}}},{key:"_handleMove",value:function(t){if(this.isDown()){var e=this.__formatTouchEvent(t);e&&(e.timestamp-this.__lastDown.timestamp<=this._longTapCancel&&s.distanceToPoint(this.__lastDown,e)<this._tapDistanceThreshold||(e.setType(a.EVENT_TYPES.MOVE),e.linkEvent(this.__lastMove),this.__lastMove=e,this.__fireEvent(e)))}}},{key:"__fireEvent",value:function(t){var e=this.__getListenersByType(t.getType());if(e.length)for(var n=0;n<e.length;n++)e[n].callback(t)}},{key:"__queueHistory",value:function(t,e){return t[0]=t[0].toUpperCase(),this["__last"+t].push(e),this["__last"+t].shift(),null}},{key:"__formatListener",value:function(t){return{key:++this.__key,callback:t}}},{key:"__formatTouchEvent",value:function(t){var e=t.changedTouches?t.changedTouches:[];if(e.length){var n=!1,o=0;do{if(!(o<e.length))return!1;t.clientX=e[o].clientX,t.clientY=e[o].clientY,n=new a(t,this.__view),o++}while(!this.collides(n))}else if(event=new a(t,this.__view),!this.collides(event))return!1;return event}},{key:"__getListenersByType",value:function(t){if(!t)return null;var e="__"+t+"Listeners";return this[e]||(this[e]=[]),this[e]}},{key:"__on",value:function(t,e){this.__getListenersByType(t).push(this.__formatListener(e))}},{key:"__off",value:function(t,e){for(var n=this.__getListenersByType(t),o=0;o<n.length;o++)n[o].callback===e&&delete n[o]}},{key:"onDouble",value:function(t){this.__on(a.EVENT_TYPES.DOUBLE,t)}},{key:"offDouble",value:function(t){this.__off(a.EVENT_TYPES.DOUBLE,t)}},{key:"onLong",value:function(t){this.__on(a.EVENT_TYPES.LONG,t)}},{key:"offLong",value:function(t){this.__off(a.EVENT_TYPES.LONG,t)}},{key:"onTap",value:function(t){this.__on(a.EVENT_TYPES.TAP,t)}},{key:"offTap",value:function(t){this.__off(a.EVENT_TYPES.TAP,t)}},{key:"onDown",value:function(t){this.__on(a.EVENT_TYPES.DOWN,t)}},{key:"offDown",value:function(t){this.__off(a.EVENT_TYPES.DOWN,t)}},{key:"onMove",value:function(t){this.__on(a.EVENT_TYPES.MOVE,t)}},{key:"offMove",value:function(t){this.__off(a.EVENT_TYPES.MOVE,t)}},{key:"onUp",value:function(t){this.__on(a.EVENT_TYPES.UP,t)}},{key:"offUp",value:function(t){this.__off(a.EVENT_TYPES.UP,t)}},{key:"isDown",value:function(){return this.__isDown}}]),e}();t.exports=p},function(t,e,n){function o(t){return(o="function"==typeof Symbol&&"symbol"===i(Symbol.iterator)?function(t){return i(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":i(t)})(t)}function r(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function u(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var a=n(8),s=n(5),f=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var t={bounding:new s({x:0,y:0,radius:20})};return u(this,c(e).call(this,t))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(e,a),function(t,e,n){e&&r(t.prototype,e),n&&r(t,n)}(e,[{key:"draw",value:function(t,e,n,o,r,i){var u=i.getDrawOptions(),c=t.getContext("2d");u.operating&&(c.beginPath(),c.arc(e,n,160,0,2*Math.PI,!1),c.fillStyle="rgba(0,255,0,0.1)",c.fill(),c.lineWidth=3,c.strokeStyle="rgba(0,255,0,0.3)",c.stroke()),c.beginPath(),c.arc(e,n,20,0,2*Math.PI,!1),c.fillStyle="#000000",c.fill(),c.lineWidth=5,c.strokeStyle="#303030",c.stroke(),c.beginPath(),c.lineWidth=18,c.strokeStyle="#333333",c.lineCap="round",c.moveTo(u.stick.x,u.stick.y),c.lineTo(e,n),c.stroke(),c.beginPath(),c.arc(u.stick.x,u.stick.y,18,0,2*Math.PI,!1),c.fillStyle="#dd2222",c.fill(),c.lineWidth=5,c.strokeStyle="#aa1111",c.stroke(),c.beginPath(),c.arc(u.stick.x+6,u.stick.y-6,4,0,2*Math.PI,!1),c.fillStyle="#ffcccc",c.fill()}}]),e}();t.exports=f},function(t,e,n){var o=n(3),r=n(4),i=n(5),u=n(6),c=n(8),l=n(9),a=n(14),s=n(15),f=n(16),p=n(2),y=n(17),h=n(18),_=n(1),b=n(7),v=n(19),d={Bounding:o,BoundingBox:u,BoundingCircle:i,BoundingPoint:r,Appearance:c,Controller:a,Background:l,Entity:s,Game:f,Generic:p,ParticleEmitter:h,Particle:y,Root:_,World:n(20),View:v,Vector:b},g=n(0),m=g.Functions,w=g.Geometry,O={Functions:m,Constants:g.Constants,Geometry:w},P={Event:n(10),Touch:n(11),Joystick:n(21)},k=n(12);TwoCylinder={Engine:d,IO:P,Sprites:{Josystick:k},Utilities:O},t.exports=TwoCylinder},function(t,e,n){function o(t){return(o="function"==typeof Symbol&&"symbol"===i(Symbol.iterator)?function(t){return i(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":i(t)})(t)}function r(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function u(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var a=n(1),s=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=u(this,c(e).call(this,t))).__world=void 0,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(e,a),function(t,e,n){e&&r(t.prototype,e),n&&r(t,n)}(e,[{key:"setWorld",value:function(t){this.__world=t}},{key:"getWorld",value:function(){return this.__world}},{key:"preStep",value:function(t){}},{key:"step",value:function(t){}},{key:"postStep",value:function(t){}}]),e}();t.exports=s},function(t,e,n){function o(t){return(o="function"==typeof Symbol&&"symbol"===i(Symbol.iterator)?function(t){return i(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":i(t)})(t)}function r(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function u(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var a=n(2),s=n(8),f=n(7),p=n(4),y=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=u(this,c(e).call(this,t))).__appearance=null,(t=Object.assign({velocity:null,rotation:0,rotation_lag:20},t)).appearance&&n.setAppearance(t.appearance),n._velocity=t.velocity,n._rotationLag=t.rotation_lag,n._rotation=t.rotation,n._collisionGroup="ENTITY",n.__id=void 0,n.__world=void 0,n.__collisionGroupListening={},n.__visible=!0,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(e,a),function(t,e,n){e&&r(t.prototype,e),n&&r(t,n)}(e,[{key:"draw",value:function(t,e,n){this.getAppearance().draw(t.getCanvas(),e,n,this)}},{key:"preStep",value:function(t){}},{key:"step",value:function(t){this.getSpeed()&&(this.getBounding().setCenter({x:this.getBounding().getCenter().x+this.getSpeed()*Math.cos(this.getDirection()),y:this.getBounding().getCenter().y+this.getSpeed()*Math.sin(this.getDirection())}),this.getAppearance()&&this.getAppearance().getBounding().setCenter(this.getBounding().getCenter()))}},{key:"postStep",value:function(t){}},{key:"getCollisionGroup",value:function(){return this._collisionGroup}},{key:"getCollidableGroups",value:function(){return Object.keys(this.__collisionGroupListening)}},{key:"handleCollidedWith",value:function(t){var e=this.objectIsCollidable(t);e&&e.apply(this,[t])}},{key:"groupIsCollidable",value:function(t){var e=!1;return this.__collisionGroupListening[other]&&(e=this.__collisionGroupListening[other]),e}},{key:"objectIsCollidable",value:function(t){return t instanceof e&&this.groupIsCollidable(t.getCollisionGroup())}},{key:"hasCollisionChecking",value:function(){return this.__collisionGroupListening.hasOwnProperty}},{key:"onCollideGroup",value:function(t,e){this.__collisionGroupListening[t]=e}},{key:"offCollideGroup",value:function(t){delete this.__collisionGroupListening[t]}},{key:"getPosition",value:function(){return this.getBounding().getCenter()}},{key:"setPosition",value:function(t,e){t instanceof p?this.getBounding().setCenter(t.getCenter()):"object"===o(t)?this.getBounding().setCenter({x:t.x,y:t.y}):this.getBounding().setCenter({x:t,y:e})}},{key:"setAppearance",value:function(t){if(!(t instanceof s))throw"Appearance must be a instance of Appearance";this.__appearance=t}},{key:"getAppearance",value:function(){return this.__appearance}},{key:"getDirection",value:function(){return this.getVelocity().getDirection()}},{key:"rotateTowards",value:function(t){this.getVelocity().rotateTowards(t,this._rotationLag)}},{key:"setDirection",value:function(t){return this.getVelocity().setDirection(t),this.getDirection()}},{key:"getSpeed",value:function(){return this.getVelocity().getSpeed()}},{key:"setSpeed",value:function(t){this.getVelocity().setSpeed(t)}},{key:"setVelocity",value:function(t){this._velocity=t}},{key:"getVelocity",value:function(){return this._velocity||(this._velocity=new f),this._velocity}},{key:"getVisible",value:function(){return this.isVisible()}},{key:"isVisible",value:function(){return this.__id&&this.__visible&&!!this.__appearance}},{key:"setVisible",value:function(t){this.__visible=t}},{key:"setWorld",value:function(t){this.__world=t}},{key:"getWorld",value:function(){return this.__world}}]),e}();t.exports=y},function(t,e,n){function o(t){return(o="function"==typeof Symbol&&"symbol"===i(Symbol.iterator)?function(t){return i(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":i(t)})(t)}function r(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function u(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var a=n(1),s=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=u(this,c(e).call(this))).__world=void 0,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(e,a),function(t,e,n){e&&r(t.prototype,e),n&&r(t,n)}(e,[{key:"start",value:function(){return this.getWorld().start()}},{key:"exit",value:function(){return this.getWorld().exit()}},{key:"setWorld",value:function(t){this.__world=t}},{key:"getWorld",value:function(){return this.__world}}]),e}();t.exports=s},function(t,e,n){function o(t){return(o="function"==typeof Symbol&&"symbol"===i(Symbol.iterator)?function(t){return i(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":i(t)})(t)}function r(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function u(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var a=n(1),s=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=u(this,c(e).call(this,t)),t=Object.assign({},t),n.__id=t.id,n.__emitter=t.emitter,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(e,a),function(t,e,n){e&&r(t.prototype,e),n&&r(t,n)}(e,[{key:"step",value:function(t){return null}},{key:"draw",value:function(t,e,n,o,r,i){var u=t.getContext("2d");u.beginPath(),u.arc(e,n,20,0,2*Math.PI,!1),u.fillStyle="grey",u.fill(),u.lineWidth=5,u.strokeStyle="#333333",u.stroke()}},{key:"destroy",value:function(){this.__emitter.removeParticle(this)}}]),e}();t.exports=s},function(t,e,n){function o(t){return(o="function"==typeof Symbol&&"symbol"===i(Symbol.iterator)?function(t){return i(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":i(t)})(t)}function r(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function u(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var a=n(0).Functions,s=n(2),f=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=u(this,c(e).call(this,t))).__particles=[],n.__toRemove=[],n.__isEmitting=!1,n.__particleKey=0,n.__id=null,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(e,s),function(t,e,n){e&&r(t.prototype,e),n&&r(t,n)}(e,[{key:"draw",value:function(t,e,n){var o=this;this.getParticles().forEach(function(r){r.draw(t.getCanvas(),e,n,o)})}},{key:"step",value:function(t){this.getParticles().forEach(function(e){e.step(t)}),this.__removeParticles()}},{key:"destroy",value:function(){this.__particles=[]}},{key:"setIsEmitting",value:function(t){this.__isEmitting=t}},{key:"getIsEmitting",value:function(){return this.__isEmitting}},{key:"getParticles",value:function(){return this.__particles}},{key:"removeParticle",value:function(t){this.__toRemove.push(t)}},{key:"__removeParticles",value:function(t){a.disjoinArray2FromArray1(this.__particles,this.__toRemove),this.__toRemove=[]}},{key:"emitParticle",value:function(t,e){var n;return n=new t(e=Object.assign({id:++this.__particleKey,emitter:this},e)),this.__particles.push(n),n}}]),e}();t.exports=f},function(t,e,n){function o(t){return(o="function"==typeof Symbol&&"symbol"===i(Symbol.iterator)?function(t){return i(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":i(t)})(t)}function r(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function u(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var a=n(2),s=n(0).Functions,f=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=u(this,c(e).call(this,t))).__canvas=t.canvas,n.__world=void 0,n._resolution=t.resolution||1,n.__canvas.width=n.getBounding().width,n.__canvas.height=n.getBounding().height,n.__canvas.style.width=n.getBounding().width*n._resolution+"px",n.__canvas.style.height=n.getBounding().height*n._resolution+"px",n.__followInstance=!1,n.__ios=[],n.__toRemoveIOs=[],n.__ioKey=0,n.__id=null,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(e,a),function(t,e,n){e&&r(t.prototype,e),n&&r(t,n)}(e,[{key:"clearCanvas",value:function(){this.__canvas.getContext("2d").clearRect(0,0,this.__canvas.width,this.__canvas.height)}},{key:"draw",value:function(t){var e=this;this.__followInstance&&this.getBounding().setCenterWithinBounding(this.__followInstance.getBounding().getCenter(),this.__world.getBounding()),this.clearCanvas(),this.__world.getBackground().draw(this),this.__world.getInstances().forEach(function(t){t.isVisible()&&e.collides(t.getAppearance().getBounding())&&t.draw(e,t.getBounding().getCenter().x-e.getBounding().getContainingRectangle().origin_x,t.getBounding().getCenter().y-e.getBounding().getContainingRectangle().origin_y)}),this.__world.getParticleEmitters().forEach(function(t){e.collides(t.getBounding())&&t.draw(e,t.getBounding().getCenter().x-e.getBounding().getContainingRectangle().origin_x,t.getBounding().getCenter().y-e.getBounding().getContainingRectangle().origin_y)}),this.__removeIOs(),this.getIOs().forEach(function(t){t.draw()})}},{key:"getCanvas",value:function(){return this.__canvas}},{key:"getWorld",value:function(){return this.__world}},{key:"setWorld",value:function(t){this.__world=t}},{key:"removeIO",value:function(t){return t.__id&&this.__toRemoveIOs.push(t),t}},{key:"__removeIOs",value:function(){s.disjoinArray2FromArray1(this.__ios,this.__toRemoveIOs),this.__toRemoveIOs=[]}},{key:"addIO",value:function(t){if(t.__id)throw"IO already added";return t.__id=++this.__ioKey,this.__ios.push(t),t}},{key:"getIOs",value:function(){return this.__ios}},{key:"getMousePosition",value:function(t){return new TwoCylinder.IO.Event(t,this)}},{key:"followInstance",value:function(t){this.__followInstance=t||!1}}]),e}();t.exports=f},function(t,e,n){function o(t){return(o="function"==typeof Symbol&&"symbol"===i(Symbol.iterator)?function(t){return i(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":i(t)})(t)}function r(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function u(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var a=n(2),s=n(9),f=n(6),p=n(0).Functions,y=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t.bounding=new f({origin_x:0,origin_y:0,width:t.width,height:t.height}),(n=u(this,c(e).call(this,t)))._fps=t.fps||30,n.__instances=[],n.__particleEmitters=[],n.__controllers=[],n.__views=[],n.__toRemoveParticleEmitters=[],n.__toRemoveInstances=[],n.__toRemoveControllers=[],n.__toRemoveViews=[],n.__collisionGroups={},n.__background=t.background||new s,n.__instanceKey=0,n.__viewKey=0,n.__emitterKey=0,n.__controllerKey=0,n.__clock=0,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(e,a),function(t,e,n){e&&r(t.prototype,e),n&&r(t,n)}(e,[{key:"start",value:function(){var t=this;this.__intervalId=setInterval(function(){try{t.loop.apply(t,[])}catch(e){t.exit(e)}},1e3/this._fps)}},{key:"__preStep",value:function(t){this.__instances.forEach(function(e){e.preStep(t)}),this.__controllers.forEach(function(e){e.preStep(t)})}},{key:"__postStep",value:function(t){this.__instances.forEach(function(e){e.postStep(t)}),this.__controllers.forEach(function(e){e.postStep(t)}),this.__removeControllers(),this.__removeParticleEmitters(),this.__removeViews(),this.__removeInstances()}},{key:"loop",value:function(){var t=this;this.__preStep(++this.__clock),this.__controllers.forEach(function(e){e.step(t.__clock)}),this.__particleEmitters.forEach(function(e){e.step(t.__clock)}),this.__instances.forEach(function(e){e.step(t.__clock)}),this.__instances.forEach(function(e){e.hasCollisionChecking()&&e.getCollidableGroups().forEach(function(n){t.__collisionGroups[n]&&t.__collisionGroups[n].length&&t.__collisionGroups[n].forEach(function(t){e.__id!==t.__id&&e.collides(t.getBounding())&&e.handleCollidedWith(t)})})}),this.__views.forEach(function(e){e.draw(t.__clock)}),this.__postStep(this.__clock)}},{key:"exit",value:function(){clearInterval(this.__intervalId)}},{key:"removeInstance",value:function(t){return t.__id&&this.__toRemoveInstances.push(t),t}},{key:"__removeInstances",value:function(){var t=this;this.__toRemoveInstances.length&&(p.disjoinArray2FromArray1(this.__instances,this.__toRemoveInstances,function(e){t.__removeFromCollisionGroup(e),e.setWorld(null)}),this.__toRemoveInstances=[])}},{key:"addInstance",value:function(t){if(t.__id)throw"Instance already added";return t.__id=++this.__instanceKey,t.setWorld(this),this.__instances.push(t),this.__addToCollisionGroup(t),t}},{key:"getInstances",value:function(){return this.__instances}},{key:"removeAllInstances",value:function(){var t=this;this.getInstances().forEach(function(e){t.removeInstance(e)})}},{key:"addView",value:function(t){if(t.__id)throw"View already added";return t.__id=++this.__viewKey,t.setWorld(this),this.__views.push(t),t}},{key:"getViews",value:function(){return this.__views}},{key:"__removeViews",value:function(){this.__toRemoveViews.length&&(p.disjoinArray2FromArray1(this.__views,this.__toRemoveViews,function(t){t.setWorld(null)}),this.__toRemoveViews=[])}},{key:"removeView",value:function(t){return t.__id&&this.__toRemoveViews.push(t),t}},{key:"addParticleEmitter",value:function(t){if(t.__id)throw"Emitter already added";return t.__id=++this.__emitterKey,this.__particleEmitters.push(t),t}},{key:"removeParticleEmitter",value:function(t){return t.__id&&this.__toRemoveParticleEmitters.push(t),t}},{key:"__removeParticleEmitters",value:function(){this.__toRemoveParticleEmitters.length&&(p.disjoinArray2FromArray1(this.__particleEmitters,this.__toRemoveParticleEmitters),this.__toRemoveParticleEmitters=[])}},{key:"getParticleEmitters",value:function(){return this.__particleEmitters}},{key:"removeAllParticleEmitters",value:function(){var t=this;this.getParticleEmitters().forEach(function(e){t.removeParticleEmitter(e)})}},{key:"addController",value:function(t){if(t.__id)throw"Emitter already added";return t.__id=++this.__controllerKey,t.setWorld(this),this.__controllers.push(t),t}},{key:"removeController",value:function(t){return t.__id&&this.__toRemoveControllers.push(t),t}},{key:"__removeControllers",value:function(){this.__toRemoveControllers.length&&(p.disjoinArray2FromArray1(this.__controllers,this.__toRemoveControllers,function(t){t.setWorld(null)}),this.__toRemoveControllers=[])}},{key:"getControllers",value:function(){return this.__controllers}},{key:"setBackground",value:function(t){this.__background=t}},{key:"getBackground",value:function(){return this.__background}},{key:"__addToCollisionGroup",value:function(t){var e=t.getCollisionGroup();this.__collisionGroups[e]||(this.__collisionGroups[e]=[]),this.__collisionGroups[e].push(t)}},{key:"__removeFromCollisionGroup",value:function(t){var e,n=t.getCollisionGroup();if(!this.__collisionGroups[n])throw"Collision Group does not exist";for(e=0;e<this.__collisionGroups[n].length;e++)if(this.__collisionGroups[n][e].__id===t.__id){this.__collisionGroups[n].splice(e,1);break}}}]),e}();t.exports=y},function(t,e,n){function o(t){return(o="function"==typeof Symbol&&"symbol"===i(Symbol.iterator)?function(t){return i(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":i(t)})(t)}function r(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function u(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var a=n(11),s=n(5),f=n(0),p=f.Geometry,y=f.Functions,h=n(12),_=function(t){function e(t){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);return t.tap_distance=0,t.bounding=new s({x:t.x,y:t.y,radius:40}),(n=u(this,c(e).call(this,t)))._defaultRadius=40,n.__isHeld=!1,n.__pullRatio=1.8,n.__operateFunction=null,n.__appearance=new h,n._previousEvent=null,n.onDown(function(t){n._previousEvent=t,n._previousEvent.linkEvent(t),n.getBounding().updateBounding({radius:4*n._defaultRadius}),"function"==typeof n.__operateFunction&&(t.velocity&&t.velocity.setSpeed(0),n.__operateFunction(t))}),n.onUp(function(t){n.getBounding().updateBounding({radius:n._defaultRadius}),delete n._previousEvent,"function"==typeof n.__operateFunction&&(t.velocity&&t.velocity.setSpeed(0),n.__operateFunction(t))}),n.onMove(function(t){n.isDown()&&(t.linkEvent(n.__lastDown),"function"==typeof n.__operateFunction&&(t.velocity&&t.velocity.setSpeed(Math.min(t.velocity.getSpeed(),n._defaultRadius/n.__pullRatio)),n.__operateFunction(t)),n._previousEvent=t)}),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(e,a),function(t,e,n){e&&r(t.prototype,e),n&&r(t,n)}(e,[{key:"onOperate",value:function(t){this.__operateFunction=t}},{key:"offOperate",value:function(){delete this.__operateFunction}},{key:"getDrawOptions",value:function(){var t={stick:this.getBounding().getCenter(),operating:this.isDown()};if(this._previousEvent&&this._previousEvent.velocity){var e=y.clone(this._previousEvent.velocity);e.setSpeed(Math.min(this._defaultRadius/this.__pullRatio,this._previousEvent.velocity.getSpeed())),t.stick=p.pointFromVector(t.stick,e)}return t}}]),e}();t.exports=_}])})}).call(this,n(3)(t))},function(t,e,n){function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function i(t){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function u(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function c(t,e,n){return e&&u(t.prototype,e),n&&u(t,n),t}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var a=n(0),s=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=r(this,i(e).call(this,t))).setPosition(t.x,t.y),n.__pixelValue=t.pixel,n.__pixelIndex=t.index,n.__health=function(t,e){var n=e/255;return{c:e-Math.round(t[0]*n),m:e-Math.round(t[1]*n),y:e-Math.round(t[2]*n)}}(n.__pixelValue,n.constructor.healthMultiplier),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(e,a.Engine.Entity),c(e,null,[{key:"healthMultiplier",get:function(){return 1}},{key:"HP_CYAN",get:function(){return"c"}},{key:"HP_MAGENTA",get:function(){return"m"}},{key:"HP_YELLOW",get:function(){return"y"}}]),c(e,[{key:"getHP",value:function(t){return t?this.__health[t]:this.__health}},{key:"getColorStyle",value:function(){return"rgb("+this.__pixelValue[0]+","+this.__pixelValue[1]+","+this.__pixelValue[2]+")"}}]),e}();t.exports=s},function(t,e,n){function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function i(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var l,a=n(0),s=n(4),f=n(5),p=800,y=1300,h=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),i(this,u(e).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(e,a.Engine.Game),function(t,e,n){e&&r(t.prototype,e),n&&r(t,n)}(e,[{key:"init",value:function(t){l=t.document.getElementById("world"),this.gameSettings=new s,this.enter("menu")}},{key:"enter",value:function(t){switch(this.beforeChange(),t){case"menu":this.enterMenu();break;case"game":this.enterGame();break;case"story":this.enterStory()}this.afterChange()}},{key:"beforeChange",value:function(){this.getWorld()&&(this.getWorld().exit(),this.setWorld(null))}},{key:"afterChange",value:function(){this.getWorld().start()}},{key:"enterGame",value:function(){var t=new a.Engine.Background({color:"#ffffff"}),e=new a.Engine.World({fps:30,width:p,height:y,background:t}),n=_(),o=new a.Engine.View({canvas:l,resolution:n.scale,bounding:e.getBounding()});e.addView(o),this.levelController=new f({world:e}),e.addController(this.levelController),this.setWorld(e)}},{key:"enterMenu",value:function(){var t=new a.Engine.Background({color:"#77ff77"}),e=new a.Engine.World({fps:30,width:p,height:y,background:t}),n=_(),o=new a.Engine.View({canvas:l,resolution:n.scale,bounding:e.getBounding()});e.addView(o),this.setWorld(e)}},{key:"enterStory",value:function(){alert("DO THIS")}}]),e}();function _(){if(p/y>window.innerWidth/window.innerHeight){var t=window.innerWidth/p;return{width:window.innerWidth,height:t*y,scale:t}}var e=window.innerHeight/y;return{height:window.innerHeight,width:e*p,scale:e}}window.OpaqueGame=h},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e){t.exports=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.health=100,this.imageSize=128,this.palette=8}},function(t,e,n){function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function i(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function u(t,e,n){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=c(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var a=n(0),s=n(6),f=n(10),p=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=i(this,c(e).call(this,t))).currentLevel=t.currentLevel||-1,n.levelIsActive=!1,n.levelIsLoading=!1,n.enemyController=null,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(e,a.Engine.Controller),function(t,e,n){e&&r(t.prototype,e),n&&r(t,n)}(e,[{key:"preStep",value:function(t){u(c(e.prototype),"preStep",this).call(this,t),this.levelIsActive||this.levelIsLoading||this.advanceLevel()}},{key:"step",value:function(t){u(c(e.prototype),"step",this).call(this,t)}},{key:"handleLevelEnd",value:function(){console.log("LEVEL END"),this.enemyController.exit(),delete this.enemyController,delete this.level,this.levelIsActive=!1}},{key:"advanceLevel",value:function(){var t=this;switch(this.currentLevel++,this.currentLevel){case 0:default:var e=y[this.currentLevel],n=new Image;n.crossOrigin="Anonymous",n.onload=function(){t.levelIsLoading=!1,e.image=n,t.level=new f(e),t.enemyController=new s({level:t.level,onLevelEnd:t.handleLevelEnd}),t.getWorld().addController(t.enemyController),t.levelIsActive=!0},n.src="./src/game/levels/images/"+e.imageName}this.levelIsLoading=!0}}]),e}(),y=[{name:"Printer Test",colorCount:3,imageName:"cmy.png"}];t.exports=p},function(t,e,n){function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function i(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function u(t,e,n){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=c(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var a=n(0),s=n(7),f=90,p=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=i(this,c(e).call(this,t))).levelInstance=t.level,n.digestLevelData(),n.enemyCreationTimeout=void 0,n.diceSides=f,n.onLevelEnd=t.onLevelEnd,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(e,a.Engine.Controller),function(t,e,n){e&&r(t.prototype,e),n&&r(t,n)}(e,[{key:"step",value:function(t){if(u(c(e.prototype),"step",this).call(this,t),this.enemyCreationTimeout>0)this.enemyCreationTimeout--;else if(0===Math.floor(Math.random()*this.diceSides)){for(var n=1+Math.round((1-this.enemyQueue.length/this.startingQueueSize)*this.levelInstance.getColorCount());n>0;)this.createEnemyInstanceFromEnemyData(this.enemyQueue.pop()),n--;this.enemyCreationTimeout=f*n}}},{key:"postStep",value:function(t){u(c(e.prototype),"postStep",this).call(this,t)}},{key:"digestLevelData",value:function(){var t=this;this.enemyQueue=[];var e={},n=this.levelInstance.getImageData();this.startingQueueSize=n.length;var o=this.startingQueueSize/this.levelInstance.getColorCount();n.forEach(function(n,r){var i=n.join(":");e[i]||(e[i]=0),e[i]++;var u={pixel:n,index:r};e[i]<o?u.type="pixel":e[i]<2*o?u.type="advanced":(e[i]-=10,u.type="boss"),t.enemyQueue.push(u)}),this.enemyQueue.reverse()}},{key:"createEnemyInstanceFromEnemyData",value:function(t){var e,n=this.getWorld().getBounding().width;switch(t.x=.8*n*Math.random()+.1*n,t.y=-100,t.type){case"pixel":e=new s(t)}if(!e)throw"Invalid enemy data";this.getWorld().addInstance(e)}},{key:"exit",value:function(){this.getWorld().removeAllInstance(),this.getWorld().removeAllParticleEmitters(),console.log("EXITED ENEMY CONTROLLER")}}]),e}();t.exports=p},function(t,e,n){function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function i(t,e,n){return(i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function c(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function l(t,e,n){return e&&c(t.prototype,e),n&&c(t,n),t}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var s=n(8),f=n(0),p=n(1),y=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t.bounding=new f.Engine.BoundingBox({width:e.size,height:e.size}),t.appearance=new s({bounding:t.bounding}),(n=r(this,u(e).call(this,t))).setDirection(Math.PI/2),n.targetSpeed=3,n.setSpeed(3),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(e,p),l(e,null,[{key:"healthMultiplier",get:function(){return 1}},{key:"size",get:function(){return 30}}]),l(e,[{key:"postStep",value:function(){if(i(u(e.prototype),"postStep",this).apply(this,arguments),this.getSpeed()===this.targetSpeed){this.targetSpeed=Math.round(5*Math.random());var t=Math.PI/2;this.targetDirection=Math.random()*Math.PI/2+Math.PI/4,this.getPosition().x<100&&this.targetDirection>t?this.targetDirection=t:this.getPosition().x>this.getWorld().getBounding().width-100&&this.targetDirection<t&&(this.targetDirection=t)}else{var n=this.targetSpeed-this.getSpeed(),o=n<0;this.setSpeed(this.getSpeed()+(o?-1:1)*Math.min(.05,Math.abs(n))),o=(n=this.targetDirection-this.getDirection())<0,this.setDirection(this.getDirection()+(o?-1:1)*Math.min(.05,Math.abs(n)))}}}]),e}();t.exports=y},function(t,e,n){function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function i(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var l=n(9),a=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),i(this,u(e).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(e,l),function(t,e,n){e&&r(t.prototype,e),n&&r(t,n)}(e,[{key:"drawNormal",value:function(t,e,n,o){var r=t.getContext("2d"),i=this.getBounding().width;r.beginPath(),r.fillStyle=o.getColorStyle(),r.moveTo(e+3,n),r.lineTo(e+i-3,n),r.quadraticCurveTo(e+i,n,e+i,n+3),r.lineTo(e+i,n+i-3),r.quadraticCurveTo(e+i,n+i,e+i-3,n+i),r.lineTo(e+3,n+i),r.quadraticCurveTo(e,n+i,e,n+i-3),r.lineTo(e,n+3),r.quadraticCurveTo(e,n,e+3,n),r.closePath(),r.fill()}},{key:"drawDamaged",value:function(t,e,n,o){}},{key:"drawHealth",value:function(t,e,n,o){}},{key:"drawDying",value:function(t,e,n,o){}}]),e}();t.exports=a},function(t,e,n){function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function i(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var l=n(0),a=n(1);var s=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=i(this,u(e).call(this,t))).memoizedHealth=void 0,n.drawingAnimation=void 0,n.showingHP=!1,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(e,l.Engine.Appearance),function(t,e,n){e&&r(t.prototype,e),n&&r(t,n)}(e,[{key:"draw",value:function(t,e,n,o){if("function"==typeof this.drawingAnimation)return this.drawingAnimation.apply(this,arguments);var r=o.getHP();!function(t,e){return!(!e||!t||t[a.HP_CYAN]===e[a.HP_CYAN]&&t[a.HP_MAGENTA]===e[a.HP_MAGENTA]&&t[a.HP_YELLOW]===e[a.HP_YELLOW])}(r,this.memoizedHealth)?this.showingHP?this.drawHealth.apply(this,arguments):!function(t){return!(0===t[a.HP_CYAN]&&0===t[a.HP_MAGENTA]&&0===t[a.HP_YELLOW])}(r)?this.drawDying():this.drawNormal.apply(this,arguments):this.drawDamaged.apply(this,arguments),this.memoizedHealth=r}},{key:"drawNormal",value:function(t,e,n,o){}},{key:"drawDamaged",value:function(t,e,n,o){}},{key:"drawHealth",value:function(t,e,n,o){}},{key:"drawDying",value:function(t,e,n,o){}}]),e}();t.exports=s},function(t,e,n){function o(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var r=n(11),i=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.name=e.name,this.imageFile=e.image,this.colorCount=e.colorCount||8,this.imageData=t.imageDataFromImage(this.imageFile,this.colorCount)}return function(t,e,n){e&&o(t.prototype,e),n&&o(t,n)}(t,[{key:"getImageData",value:function(){return this.imageData}},{key:"getColorCount",value:function(){return this.colorCount}}],[{key:"imageDataFromImage",value:function(t,e){var n=window.document.createElement("canvas");n.width=t.width,n.height=t.height,n.getContext("2d").drawImage(t,0,0,t.width,t.height);for(var o=n.getContext("2d").getImageData(0,0,n.width,n.height).data,i=[],u=0;u<o.length;u+=4)i.push([o[u],o[u+1],o[u+2]]);var c=r.quantize(i,e);return i.map(function(t){return c.map(t)})}}]),t}();t.exports=i},function(t,e){var n={map:function(t,e){var n={};return e?t.map(function(t,o){return n.index=o,e.call(n,t)}):t.slice()},naturalOrder:function(t,e){return t<e?-1:t>e?1:0},sum:function(t,e){var n={};return t.reduce(e?function(t,o,r){return n.index=r,t+e.call(n,o)}:function(t,e){return t+e},0)},max:function(t,e){return Math.max.apply(null,e?n.map(t,e):t)}},o=function(){var t=5,e=8-t,o=1e3,r=.75;function i(e,n,o){return(e<<2*t)+(n<<t)+o}function u(t){var e=[],n=!1;function o(){e.sort(t),n=!0}return{push:function(t){e.push(t),n=!1},peek:function(t){return n||o(),void 0===t&&(t=e.length-1),e[t]},pop:function(){return n||o(),e.pop()},size:function(){return e.length},map:function(t){return e.map(t)},debug:function(){return n||o(),e}}}function c(t,e,n,o,r,i,u){this.r1=t,this.r2=e,this.g1=n,this.g2=o,this.b1=r,this.b2=i,this.histo=u}function l(){this.vboxes=new u(function(t,e){return n.naturalOrder(t.vbox.count()*t.vbox.volume(),e.vbox.count()*e.vbox.volume())})}function a(t,e){if(e.count()){var o=e.r2-e.r1+1,r=e.g2-e.g1+1,u=e.b2-e.b1+1,c=n.max([o,r,u]);if(1==e.count())return[e.copy()];var l,a,s,f,p=0,y=[],h=[];if(c==o)for(l=e.r1;l<=e.r2;l++){for(f=0,a=e.g1;a<=e.g2;a++)for(s=e.b1;s<=e.b2;s++)f+=t[i(l,a,s)]||0;p+=f,y[l]=p}else if(c==r)for(l=e.g1;l<=e.g2;l++){for(f=0,a=e.r1;a<=e.r2;a++)for(s=e.b1;s<=e.b2;s++)f+=t[i(a,l,s)]||0;p+=f,y[l]=p}else for(l=e.b1;l<=e.b2;l++){for(f=0,a=e.r1;a<=e.r2;a++)for(s=e.g1;s<=e.g2;s++)f+=t[i(a,s,l)]||0;p+=f,y[l]=p}return y.forEach(function(t,e){h[e]=p-t}),_(c==o?"r":c==r?"g":"b")}function _(t){var n,o,r,i,u,c=t+"1",a=t+"2",s=0;for(l=e[c];l<=e[a];l++)if(y[l]>p/2){for(r=e.copy(),i=e.copy(),u=(n=l-e[c])<=(o=e[a]-l)?Math.min(e[a]-1,~~(l+o/2)):Math.max(e[c],~~(l-1-n/2));!y[u];)u++;for(s=h[u];!s&&y[u-1];)s=h[--u];return r[a]=u,i[c]=r[a]+1,[r,i]}}}return c.prototype={volume:function(t){return this._volume&&!t||(this._volume=(this.r2-this.r1+1)*(this.g2-this.g1+1)*(this.b2-this.b1+1)),this._volume},count:function(t){var e=this.histo;if(!this._count_set||t){var n,o,r,u=0;for(n=this.r1;n<=this.r2;n++)for(o=this.g1;o<=this.g2;o++)for(r=this.b1;r<=this.b2;r++)u+=e[i(n,o,r)]||0;this._count=u,this._count_set=!0}return this._count},copy:function(){return new c(this.r1,this.r2,this.g1,this.g2,this.b1,this.b2,this.histo)},avg:function(e){var n=this.histo;if(!this._avg||e){var o,r,u,c,l=0,a=1<<8-t,s=0,f=0,p=0;for(r=this.r1;r<=this.r2;r++)for(u=this.g1;u<=this.g2;u++)for(c=this.b1;c<=this.b2;c++)l+=o=n[i(r,u,c)]||0,s+=o*(r+.5)*a,f+=o*(u+.5)*a,p+=o*(c+.5)*a;this._avg=l?[~~(s/l),~~(f/l),~~(p/l)]:[~~(a*(this.r1+this.r2+1)/2),~~(a*(this.g1+this.g2+1)/2),~~(a*(this.b1+this.b2+1)/2)]}return this._avg},contains:function(t){var n=t[0]>>e;return gval=t[1]>>e,bval=t[2]>>e,n>=this.r1&&n<=this.r2&&gval>=this.g1&&gval<=this.g2&&bval>=this.b1&&bval<=this.b2}},l.prototype={push:function(t){this.vboxes.push({vbox:t,color:t.avg()})},palette:function(){return this.vboxes.map(function(t){return t.color})},size:function(){return this.vboxes.size()},map:function(t){for(var e=this.vboxes,n=0;n<e.size();n++)if(e.peek(n).vbox.contains(t))return e.peek(n).color;return this.nearest(t)},nearest:function(t){for(var e,n,o,r=this.vboxes,i=0;i<r.size();i++)((n=Math.sqrt(Math.pow(t[0]-r.peek(i).color[0],2)+Math.pow(t[1]-r.peek(i).color[1],2)+Math.pow(t[2]-r.peek(i).color[2],2)))<e||void 0===e)&&(e=n,o=r.peek(i).color);return o},forcebw:function(){var t=this.vboxes;t.sort(function(t,e){return n.naturalOrder(n.sum(t.color),n.sum(e.color))});var e=t[0].color;e[0]<5&&e[1]<5&&e[2]<5&&(t[0].color=[0,0,0]);var o=t.length-1,r=t[o].color;r[0]>251&&r[1]>251&&r[2]>251&&(t[o].color=[255,255,255])}},{quantize:function(s,f){if(!s.length||f<2||f>256)return!1;var p=function(n){var o,r,u,c,l=new Array(1<<3*t);return n.forEach(function(t){r=t[0]>>e,u=t[1]>>e,c=t[2]>>e,o=i(r,u,c),l[o]=(l[o]||0)+1}),l}(s);p.forEach(function(){});var y=function(t,n){var o,r,i,u=1e6,l=0,a=1e6,s=0,f=1e6,p=0;return t.forEach(function(t){o=t[0]>>e,r=t[1]>>e,i=t[2]>>e,o<u?u=o:o>l&&(l=o),r<a?a=r:r>s&&(s=r),i<f?f=i:i>p&&(p=i)}),new c(u,l,a,s,f,p,n)}(s,p),h=new u(function(t,e){return n.naturalOrder(t.count(),e.count())});function _(t,e){for(var n,r=1,i=0;i<o;)if((n=t.pop()).count()){var u=a(p,n),c=u[0],l=u[1];if(!c)return;if(t.push(c),l&&(t.push(l),r++),r>=e)return;if(i++>o)return}else t.push(n),i++}h.push(y),_(h,r*f);for(var b=new u(function(t,e){return n.naturalOrder(t.count()*t.volume(),e.count()*e.volume())});h.size();)b.push(h.pop());_(b,f-b.size());for(var v=new l;b.size();)v.push(b.pop());return v}}}();t.exports=o}])});
//# sourceMappingURL=opaque.min.js.map